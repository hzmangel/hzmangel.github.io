<!DOCTYPE html>
<html lang="zh-cn">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />

        <meta property="og:title" content=" Admin &middot;  湖间小筑" />
        <meta property="og:site_name" content="湖间小筑" />
        <meta property="og:url" content="http://hzmangel.github.io/tags/admin/" />

        
            <meta property="og:type" content="website" />
        

        <title>
            湖间小筑
            
                | Admin
            
        </title>

        <meta name="description" content="" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="http://hzmangel.github.io/css/screen.css" />

        <link rel="canonical" href="http://hzmangel.github.io/tags/admin/" />
    </head>

    <body>
        <div class="container" id="site-wrapper">
            <header>
    <div class="row">
        <div class="col-md-6" id="site-title">
            <a href="http://hzmangel.github.io/" title="湖间小筑" rel="home"><h2>湖间小筑</h2></a>
        </div>

        <div class="col-md-6" id="site-description">
            <i class="text-right muted"><div id="site-description">蓝天，小湖，湖水中一方小筑</div></i>
        </div>
    </div>

    <img src="/img/banner.jpg" class="img-responsive">
</header>

            <nav role="navigation">

</nav>






    <article class="post">

    <header>
        <h2 class="post-title"><a href='http://hzmangel.github.io/post/618/'> Reuse the TIME_WAIT Port</a> </h2>
        <div class="post-meta">发表于2010-05-05 15:08:38 </div>
    </header>

    <section>
        <div class="post-summary">最近在调试的时候，经常会需要直接kill掉监听的进程，然后在SLES上再启动进程的时候就会报端口被占用，用netstat查看会发现这个端口处于TIME_WA IT状态。此状态是表示，当机器A发出CLOSE请求后，经过FIN_WAIT_1和FIN_WAIT_2，机器B会将socket置于CLOSE状态，此时机器B会 将端口置于 TIME_WAIT状态一定时间(2*msl)以保证机器B的数据不会丢失。这一策略可以保证TCP的可靠性，但是在测试过程中经常会报端口被占用，da emon启动错误的信息。 解决的方法一是减少msl时间，让TIME_WAIT的socket尽快结束，这个值好像可以在/proc/sys/net/ipv4/tcp_fin_timeou t中指定，不过不是很确定。再一种方式就是通过设置reuse标志位，让处于TIME_WAIT状态的端口可以被新的进程bind，此方式同样需要动/proc系统中 的东西： net.ipv4.tcp_tw_recycle = 1 net.ipv4.tcp_tw_reuse = 1 其实我也不太确定第一个是做什么用的，只是照猫画虎了。这个方式的写法是写在/etc/sysctl.conf文件中的，而不需要直接向/proc文件系统中echo 东西。在改完sysctl.conf文件后运行sysctl -p让配置生效。还有一点需要注意的是可能需要运行如下的命令刷新缓存 sysctl -w net.ipv4.route.flush=1 差不多就这些了，话说，很诡异的一点就是，这个情况只在ppc64_sles11中碰到过，x86/amd64都没碰到过，ppc64_rh5没做测试，不表态，嗯。 话说文章里面TCP状态所表示的含义及转换关系是我自己的理解，嘿嘿，自辨对错哈~~</div>
    </section>

    

</article>


    <article class="post">

    <header>
        <h2 class="post-title"><a href='http://hzmangel.github.io/post/610/'> Using sudo in rsh&#39;s command</a> </h2>
        <div class="post-meta">发表于2010-03-22 17:47:21 </div>
    </header>

    <section>
        <div class="post-summary">公司的产品需要配置无密码rsh，刚写了一个脚本用于重置环境，但是被系统告知sudo需要在tty的环境下用，所以只好去找把这个安全选项禁掉的方法。开始想当然的 把pts加到/etc/securetty中，可惜不行，最后求助于G神才发现需要在/etc/sudoers中把下面这行注释掉 Defaults requiretty 最后说一句，最好用visudo编辑，而不要手动改~</div>
    </section>

    

</article>


    <article class="post">

    <header>
        <h2 class="post-title"><a href='http://hzmangel.github.io/post/482/'> 强制umount无响应NFS分区</a> </h2>
        <div class="post-meta">发表于2009-10-23 10:12:09 </div>
    </header>

    <section>
        <div class="post-summary">折腾机器的时候，不小心mount上了一个NFS分区，然后那台机器又十分神奇的挂了，只好想着点子去umount了，要不然ls都有问题。 直接umount -f，丫在那等了N久告诉我RPC啥错，然后说device忙，于是乎只有这样了： `# fuser -km /mnt/dir umount -f /mnt/dir` Updated at 2011-01-11 唔，在网上又找到了一个办法 umount -l: Lazy unmount. Detach the filesystem from the filesystem hierarchy now, and cleanup all references to the filesystem as soon as it is not busy anymore. 试了一下，满好用，就是在-l后可能还需要等一段时间才能再次mount，不过那个目录应该是放出来了。</div>
    </section>

    

</article>


    <article class="post">

    <header>
        <h2 class="post-title"><a href='http://hzmangel.github.io/post/328/'> 无密码rsh</a> </h2>
        <div class="post-meta">发表于2008-07-18 09:52:20 </div>
    </header>

    <section>
        <div class="post-summary">最近在弄 LL，在起服务的时候，出现了权限错误的问题，问了一下才知道要把 rsh 配好，而且要无密码登录。上网找了一下，有以下地方要改：/etc/hosts.equiv和家目录下的.rhosts文件，把需要登录的主机名加进去。然后要把rsh/rlogin/rexec加到文件/etc/securetty中，然后就差不多了好像~</div>
    </section>

    

</article>



<nav id="pager">
    <div class="row">
        <div class="col-md-6">
            
        </div>

        <div class="col-md-6">
            
        </div>
    </div>
</nav>


        <footer class="site-footer clearfix">
            <div id="colophon">
                <section class="col-md-7">Copyright - ©2015 - hzmangel</section>
                
                    <i class="text-right"><section class="col-md-5">Proudly generated by <a class="icon-hugo" href="http://gohugo.io">HUGO</a>, with <a class="icon-theme" href="https://github.com/hzmangel/hugo-twenty-ten">ported Twenty Ten</a> theme</section></i>
                
            </div>
        </footer>

        <script src="http://code.jquery.com/jquery-git2.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="http://hzmangel.github.io/js/index.js"></script>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-1847567-5', 'auto');
            ga('send', 'pageview');
        </script>

    </div> 

</body>
</html>

